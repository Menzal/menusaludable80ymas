<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Menú Semanal Mediterráneo</title>
  <!--
    Este es un archivo HTML auto-contenido.
    Los estilos de Tailwind CSS han sido integrados directamente
    para que pueda ser compartido y visualizado sin necesidad
    de conexión a internet (una vez descargado).
    Simplemente guarda este código como un archivo .html y ábrelo en tu navegador.
  -->
  <style type="text/css">
    /*! tailwindcss v3.4.1 | MIT License | https://tailwindcss.com */
    *,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:""}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / .5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / .5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.mx-auto{margin-left:auto;margin-right:auto}.mb-2{margin-bottom:.5rem}.mb-3{margin-bottom:.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mr-2{margin-right:.5rem}.h-4{height:1rem}.w-1\/12{width:8.333333%}.w-4{width:1rem}.w-full{width:100%}.max-w-6xl{max-width:72rem}.min-h-\[5rem\]{min-height:5rem}.min-h-\[6rem\]{min-height:6rem}.flex-grow{flex-grow:1}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-center{justify-content:center}.gap-4{gap:1rem}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.overflow-x-auto{overflow-x:auto}.rounded{border-radius:.25rem}.rounded-lg{border-radius:.5rem}.border{border-width:1px}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity))}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity))}.bg-blue-50{--tw-bg-opacity:1;background-color:rgb(239 246 255 / var(--tw-bg-opacity))}.bg-blue-200{--tw-bg-opacity:1;background-color:rgb(191 219 254 / var(--tw-bg-opacity))}.bg-blue-500{--tw-bg-opacity:1;background-color:rgb(59 130 246 / var(--tw-bg-opacity))}.hover\:bg-blue-600:hover{--tw-bg-opacity:1;background-color:rgb(37 99 235 / var(--tw-bg-opacity))}.bg-green-500{--tw-bg-opacity:1;background-color:rgb(34 197 94 / var(--tw-bg-opacity))}.hover\:bg-green-600:hover{--tw-bg-opacity:1;background-color:rgb(22 163 74 / var(--tw-bg-opacity))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68 / var(--tw-bg-opacity))}.hover\:bg-red-600:hover{--tw-bg-opacity:1;background-color:rgb(220 38 38 / var(--tw-bg-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}.bg-yellow-500{--tw-bg-opacity:1;background-color:rgb(234 179 8 / var(--tw-bg-opacity))}.hover\:bg-yellow-600:hover{--tw-bg-opacity:1;background-color:rgb(202 138 4 / var(--tw-bg-opacity))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity))}.hover\:bg-gray-100:hover{--tw-bg-opacity:1;background-color:rgb(243 244 246 / var(--tw-bg-opacity))}.p-1{padding:.25rem}.p-1\.5{padding:.375rem}.p-2{padding:.5rem}.p-4{padding:1rem}.px-4{padding-left:1rem;padding-right:1rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.text-center{text-align:center}.font-sans{font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji"}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.font-semibold{font-weight:600}.italic{font-style:italic}.text-blue-600{--tw-text-opacity:1;color:rgb(37 99 235 / var(--tw-text-opacity))}.text-blue-700{--tw-text-opacity:1;color:rgb(29 78 216 / var(--tw-text-opacity))}.text-blue-800{--tw-text-opacity:1;color:rgb(30 64 175 / var(--tw-text-opacity))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity))}.line-through{text-decoration-line:line-through}.shadow{--tw-shadow:0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.focus\:border-blue-500:focus{--tw-border-opacity:1;border-color:rgb(59 130 246 / var(--tw-border-opacity))}.focus\:ring-blue-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(59 130 246 / var(--tw-ring-opacity))}table{border-collapse:collapse}.table-fixed{table-layout:fixed}textarea{resize:none}.hidden{display:none}@media (min-width:640px){.sm\:text-base{font-size:1rem;line-height:1.5rem}.sm\:hidden{display:none}}@media print{.no-print{display:none!important}textarea{border:none!important;resize:none!important;height:auto!important;overflow:visible!important;white-space:pre-wrap!important;-webkit-print-color-adjust:exact!important;print-color-adjust:exact!important}#menuTable{page-break-after:always}body{-webkit-print-color-adjust:exact!important;print-color-adjust:exact!important}table,td,th{border-color:#ccc!important}tbody tr[data-meal],thead tr{-webkit-print-color-adjust:exact!important;print-color-adjust:exact!important}}
  </style>
  <style>
    @media print {
      /* .no-print { display: none !important; } Done by Tailwind */
      /* textarea styles are already in the Tailwind CSS block for print */
      /* #menuTable { page-break-after: always; } Done by Tailwind */
      /* body color adjust is in Tailwind CSS block */
      /* table border colors are in Tailwind CSS block */
      /* table row/header background colors are in Tailwind CSS block */
    }
  </style>
</head>
<body class="bg-blue-50 font-sans p-4">
  <div class="max-w-6xl mx-auto">
    <h1 class="text-3xl font-bold text-center mb-4 text-blue-700">🥗 Planificador de Menú Mediterráneo</h1>
    <p class="text-center text-gray-700 mb-6">Saludable para personas mayores con diabetes y colesterol.</p>

    <div class="overflow-x-auto shadow-lg rounded-lg">
      <table class="table-fixed w-full border border-gray-300 mb-4" id="menuTable">
        <thead>
          <tr class="bg-blue-200 text-blue-800">
            <th class="p-2 border border-gray-300 w-1/12">Comida <br class="sm:hidden"/>\\ Día</th>
            <th class="p-2 border border-gray-300">Lunes</th>
            <th class="p-2 border border-gray-300">Martes</th>
            <th class="p-2 border border-gray-300">Miércoles</th>
            <th class="p-2 border border-gray-300">Jueves</th>
            <th class="p-2 border border-gray-300">Viernes</th>
            <th class="p-2 border border-gray-300">Sábado</th>
            <th class="p-2 border border-gray-300">Domingo</th>
          </tr>
        </thead>
        <tbody>
          <tr class="bg-white" data-meal="desayuno">
            <td class="p-2 border border-gray-300 font-semibold text-sm sm:text-base">🍞 Desayuno</td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[5rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[5rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[5rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[5rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[5rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[5rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[5rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
          </tr>
          <tr class="bg-gray-50" data-meal="comida">
            <td class="p-2 border border-gray-300 font-semibold text-sm sm:text-base">🍽️ Comida</td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[6rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[6rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[6rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[6rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[6rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[6rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[6rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
          </tr>
          <tr class="bg-white" data-meal="cena">
            <td class="p-2 border border-gray-300 font-semibold text-sm sm:text-base">🍲 Cena</td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[6rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[6rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[6rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[6rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[6rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[6rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
            <td class="p-2 border border-gray-300"><textarea class="w-full min-h-[6rem] p-1.5 text-sm border-gray-200 rounded focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="flex flex-wrap gap-4 justify-center mb-6 no-print">
      <button onclick="generarMenu()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg shadow transition-colors">🎲 Generar Menú</button>
      <button onclick="limpiarTabla()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg shadow transition-colors">🧹 Limpiar</button>
      <button onclick="generarListaCompra()" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg shadow transition-colors">🛒 Lista Compra</button>
      <button onclick="window.print()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg shadow transition-colors">🖨️ Imprimir</button>
    </div>

    <div class="bg-white p-4 rounded-lg shadow-lg" id="listaCompraContainer">
      <h2 class="text-xl font-bold mb-3 text-blue-700">🛍️ Lista de la Compra</h2>
      <ul id="listaCompra" class="text-gray-700 space-y-2 text-sm"></ul>
      <p id="listaCompraVacia" class="text-gray-500 italic hidden">La lista de la compra está vacía. Genere un menú y luego la lista.</p>
    </div>
  </div>

<script>
const opciones = {
  desayuno: [
    "Pan integral con tomate 🍅 y aceite de oliva virgen extra",
    "Yogur natural (sin azúcar) con avena y frutos rojos 🥣 (fresas, arándanos)",
    "Fruta fresca de temporada (ej. naranja 🍊) y un puñado de nueces 🥜",
    "Tostadas integrales con aguacate 🥑 y una pizca de pimienta",
    "Queso fresco bajo en grasa con rodajas de pepino 🥒 y tomate cherry 🍅",
    "Batido de espinacas, manzana verde 🍏 y jengibre con semillas de chía"
  ],
  comida: [
    "Ensalada grande de hojas verdes 🥗 (lechuga, rúcula) con garbanzos, pepino, pimiento y atún natural.\\nAderezo: aceite de oliva y vinagre.",
    "Crema de calabaza casera 🎃 (sin nata, usar patata para espesar).\\nMerluza al horno 🐟 con espárragos trigueros y limón 🍋.",
    "Sopa de verduras de temporada 🍲 (puerro, zanahoria, apio).\\nFilete de pavo a la plancha con ensalada de tomate 🍅 y orégano.",
    "Lentejas estofadas con verduras 🥕🧅 (sin chorizo, añadir pimentón dulce).\\nFruta de postre 🥝.",
    "Gazpacho andaluz casero 🍅🥒 (controlar sal).\\nTortilla de espinacas y champiñones 🍄 (2 huevos).",
    "Salmón al papillote con verduras juliana (calabacín, zanahoria, cebolla) 🐟🥕🧅.\\nQuinoa cocida como guarnición."
  ],
  cena: [
    "Puré de calabacín y puerro ligero 🥒.\\nHuevo cocido 🥚 y una pieza de fruta 🍑.",
    "Sopa juliana de verduras casera 🍵.\\nQueso fresco bajo en grasa con tomate en rodajas 🍅 y albahaca.",
    "Ensalada de canónigos, remolacha cocida y zanahoria rallada 🥬🥕.\\nTofu a la plancha marinado en salsa de soja baja en sodio y jengibre.",
    "Crema de champiñones casera 🍄 (sin nata).\\nPechuga de pollo al horno con hierbas provenzales 🍗.",
    "Consomé vegetal desgrasado 🍵.\\nRevuelto de setas 🍄 y gambas 🍤 con ajo y perejil (poco aceite).",
    "Pescado blanco (ej. lubina) a la plancha con brócoli al vapor 🥦🐟.\\nInfusión digestiva."
  ]
};

function generarMenu() {
  document.querySelectorAll('#menuTable tr[data-meal]').forEach(row => {
    const tipo = row.getAttribute('data-meal');
    const opcionesDisponibles = opciones[tipo];
    if (!opcionesDisponibles || opcionesDisponibles.length === 0) return;

    let ultimaOpcionIndex = -1;
    const celdas = row.querySelectorAll('textarea');

    celdas.forEach((celda) => {
      let random;
      if (opcionesDisponibles.length > 1) {
        do {
          random = Math.floor(Math.random() * opcionesDisponibles.length);
        } while (random === ultimaOpcionIndex);
      } else {
        random = 0; 
      }
      celda.value = opcionesDisponibles[random];
      ultimaOpcionIndex = random;
      autoResizeTextarea(celda); 
    });
  });
  actualizarEstadoListaCompraVacia();
}

function limpiarTabla() {
  document.querySelectorAll("#menuTable textarea").forEach(input => {
    input.value = "";
    autoResizeTextarea(input); 
  });
  document.getElementById("listaCompra").innerHTML = "";
  actualizarEstadoListaCompraVacia();
}

function generarListaCompra() {
  const lista = new Set();
  document.querySelectorAll('#menuTable textarea').forEach(t => {
    const comidas = t.value.split(/\\n|\n/); 
    comidas.forEach(comida => {
      let itemPrincipal = comida.split(/ con | y | a la | de /)[0].trim(); 
      itemPrincipal = itemPrincipal.replace(/ \(.*?\)| \/.*?\/| 🥗| 🍗| 🍠| 🐟| 🍲| 🍋| 🥕| 🍅| 🍳| 🥒| 🥚| 🍵| 🥬| 🍽️| 🧄| 🌿| 🥣| 🍎| 🥜| 🥑| 🍐| 🎃| 🍄| 🧅| 🥝| 🍑| 🍤| 🥦| 🍊| 🍏/g, '').trim();

      if (itemPrincipal && itemPrincipal.length > 2 && !itemPrincipal.toLowerCase().includes("ej.") && !itemPrincipal.toLowerCase().includes("aderezo:") && !itemPrincipal.toLowerCase().includes("fruta de postre") && !itemPrincipal.toLowerCase().includes("infusión digestiva")) {
        lista.add(capitalizeFirstLetter(itemPrincipal));
      }

      const ingredientesComunes = ["tomate", "aceite de oliva", "yogur natural", "avena", "frutos rojos", "nueces", "aguacate", "queso fresco", "pollo", "merluza", "pavo", "lentejas", "espinacas", "calabacín", "huevo", "puerro", "tofu", "salmón", "quinoa", "garbanzos", "pepino", "pimiento", "atún", "limón", "zanahoria", "apio", "cebolla", "calabaza", "champiñones", "setas", "gambas", "brócoli", "manzana", "jengibre", "semillas de chía", "rúcula", "canónigos", "remolacha", "albahaca", "ajo", "perejil", "hierbas provenzales"];
      ingredientesComunes.forEach(ing => {
        if (comida.toLowerCase().includes(ing)) {
          lista.add(capitalizeFirstLetter(ing));
        }
      });
    });
  });

  const ul = document.getElementById('listaCompra');
  ul.innerHTML = ''; 

  if (lista.size === 0) {
    actualizarEstadoListaCompraVacia();
    return;
  }

  Array.from(lista).sort().forEach(item => {
    const li = document.createElement('li');
    li.className = 'flex items-center hover:bg-gray-100 p-1 rounded';
    li.innerHTML = `<input type='checkbox' class='mr-2 h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500' onclick='toggleTachado(this)'> <span class='flex-grow'>${item}</span>`;
    ul.appendChild(li);
  });
  actualizarEstadoListaCompraVacia();
}

function capitalizeFirstLetter(string) {
  return string.charAt(0).toUpperCase() + string.slice(1);
}

function toggleTachado(checkbox) {
  const texto = checkbox.nextElementSibling;
  if (checkbox.checked) {
    texto.classList.add('line-through', 'text-gray-400');
  } else {
    texto.classList.remove('line-through', 'text-gray-400');
  }
}

function autoResizeTextarea(textarea) {
  textarea.style.height = 'auto'; 
  textarea.style.height = textarea.scrollHeight + 'px'; 
}

function actualizarEstadoListaCompraVacia() {
  const ul = document.getElementById('listaCompra');
  const pVacia = document.getElementById('listaCompraVacia');
  if (ul.children.length === 0) {
    pVacia.classList.remove('hidden');
  } else {
    pVacia.classList.add('hidden');
  }
}

document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll("#menuTable textarea").forEach(textarea => {
    textarea.addEventListener('input', () => autoResizeTextarea(textarea));
    autoResizeTextarea(textarea); 
  });
  actualizarEstadoListaCompraVacia(); 
});

</script>
</body>
</html>